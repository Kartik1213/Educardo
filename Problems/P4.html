<!doctype html>
<html>
	<body>

	<h1>Brackets</h1>
	<br><br>
 
There are k types of brackets each with its own opening bracket and
closing bracket. We assume that the first pair is denoted by the
numbers 1 and k+1, the second by 2 and k+2 and so on. Thus the
opening brackets are denoted by 1,2,.., k, and the corresponding
closing brackets are denoted by k+1,k+2,..., 2*k respectively.<br><br>

	
Some sequences with elements from 1,2, ... 2*k form well-bracketed	
sequences while others don't. A sequence is well-bracketed, if we
can match or pair up opening brackets and closing brackets of the
same type in such a way that the following holds:
 1) every bracket is paired up
 2) in each matched pair, the opening bracket occurs before the
closing bracket
 3) for a matched pair, any other matched pair lies either
completely between them or outside them.<br><br>


For the examples discussed below, let us assume that k = 2. The
sequence 1,1,3 is not well-bracketed as one of the two 1's cannot be
paired. The sequence 3,1,3,1 is not well-bracketed as there is no
way to match the second 1 to a closing bracket occurring after it.
The sequence 1,2,3,4 is not well-bracketed as the matched pair 2,4
is neither completely between the matched pair 1,3 nor completely
outside it. That is, the matched pairs cannot overlap. The sequence
1,2,4,3,1,3 is well-bracketed. We match the first 1 with the first
3, the 2 with the 4 and the second 1 with the second 3, satisfying
all the 3 conditions. If you rewrite these sequences using [,{,],}
instead of 1,2,3,4 respectively, this will be quite clear.<br><br>

In this problem you are given a sequence of brackets, of length N:
B[1], .., B[N], where each B[i] is one of the brackets. You are
also given an array of Values: V[1],.., V[N].<br><br>

Among all the subsequences in the Values array, such that the
corresponding bracket subsequence in the B Array is a well-bracketed
sequence, you need to find the maximum sum.<br><br>

Suppose N = 6, k = 3 and the values of V and B are as follows:<br><br>

 i 1 2 3 4 5 6<br>
V[i] 4 5 -2 1 1 6<br>
B[i] 1 3 4 2 5 6<br><br>

Then, the brackets in positions 1,3 form a well-bracketed sequence
(1,4) and the sum of the values in these positions is 2 (4 + -2 =
2). The brackets in positions 1,3,4,5 form a well-bracketed sequence
(1,4,2,5) and the sum of the values in these positions is 4.
Finally, the brackets in positions 2,4,5,6 forms a well-bracketed
sequence (3,2,5,6) and the sum of the values in these positions is
13. The sum of the values in positions 1,2,5,6 is 16 but the
brackets in these positions (1,3,5,6) do not form a well-bracketed
sequence. You can check the best sum from positions whose brackets
form a well-bracketed sequence is 13.<br><br>


<h3>Input Format:<br></h3>
One line, which contains (2*N + 2) space separate integers. The
first integer denotes N. The next integer is k. The next N integers
are V[1],..., V[N]. The last N integers are B[1],.., B[N].<br><br>

<h3>Output Format:<br></h3>
One integer, which is the maximum sum possible satisfying the
requirement
mentioned above.<br><br>

<h3>Constraints:</h3>
1 &le; k &le; 7
-10^6 &le; V[i] &le; 10^6, for all i
1 &le; B[i] &le; 2*k, for all i.<br><br>

<h3>Subtasks:</h3>
For 40% of the marks, 1 &le; n &le; 10
For 100% of the marks, 1 &le; n &le; 700<br><br>

<h3>Sample Input:<br></h3>
6 3 4 5 -2 1 1 6 1 3 4 2 5 6<br><br>

<h3>Sample Output:<br></h3>
13<br>
<br><br><br><br>

</body>
</html>
